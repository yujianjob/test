(function(){var b={cssTxt:".SelectXx1FocusElmStyle{background:#EEEFF8;color:#0033FF;}.SelectXx1WidthHelper{position:absolute;top:0px;left:0px;padding:0px 0px 0px 2px;visibility:hidden;background:red;}.SelectXx1Panel{position:absolute;background:#E5E5F5;padding:1px;border-top:1px solid #FFF;border-left:1px solid #99AABB;border-right:1px solid #667788;border-bottom:1px solid #445560;font-family:\u5b8b\u4f53;font-size:12px;overflow-x:hidden;overflow-y:auto;filter:alpha(Opacity=90);-moz-opacity:0.90;opacity:0.90;}.SelectXx1Panel .opt{height:20px;}.SelectXx1Panel .optCkb{float:left;width:20px;line-height:10px;height:10px;cursor:pointer;margin-top:0px;}.SelectXx1Panel .optTxt{float:left;line-height:20px;height:20px;cursor:pointer;color:#220011;padding:0px 0px 0px 2px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}.SelectXx1Panel .chsd{background:#D5D5E5;color:green;}.SelectXx1Panel .msor{background:#1C70F9;color:#FFF;}",
appendCssFlag:!1,appendCss:function(){var a=document.createElement("style");a.type="text/css";a.styleSheet?a.styleSheet.cssText=b.cssTxt:a.innerHTML=b.cssTxt;document.body.appendChild(a)},makeElm:function(a,b,c,d,g){a=document.createElement(a);if(d)for(var h in d)a[h]=d[h];if(c)a.className=c;if(g)for(var i in g)a.style[i]=g[i];b&&b.appendChild(a);return a},addEvent:function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)},getElmOffset:function(a){var e=a.offsetLeft,c=a.offsetTop;
if(a.offsetParent){var d=b.getElmOffset(a.offsetParent);e+=d.left;c+=d.top}return{left:e,right:e+a.offsetWidth,top:c,bottom:c+a.offsetHeight}},setElmStyle:function(a,b){for(var c in b)a.style[c]=b[c]},escapeHtml:function(a){return a.replace(/&/g,"&amp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;").replace(/\n/g,"<br>").replace(/\s/g,"&nbsp;")},ajax:function(a,b,c){var d=null;if(window.XMLHttpRequest)d=new XMLHttpRequest;else try{d=new ActiveXObject("Microsoft.XMLHTTP")}catch(g){d=new ActiveXObject("Msxml2.XMLHTTP")}d.open("post",
a);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a=[];if(b!=null)for(var h in b)if(b[h]!=null)if(typeof b[h]=="object"&&b[h].length)for(var i=0;i<b[h].length;i++)a[a.length]=h+"="+encodeURIComponent(b[h][i]);else a[a.length]=h+"="+encodeURIComponent(b[h]);d.onreadystatechange=function(){d.readyState==4&&d.status==200&&c(d.responseText)};d.send(a.join("&"))},mergeObjectAttrs:function(a){for(var b={},c=0;c<a.length;c++)if(a[c])for(var d in a[c])b[d]=a[c][d];return b},defaultCustomParams:{multiSelectFlag:!0,
hasFirstOpt:!0,firstOptText:"--------",firstOptValue:"",firstOptTextInSrcElm:"",optMode:"text",optDelimiter:"-",showTextMode:"text",showTextDelimiter:",",inputListen:"none",inputMatchMode:"text",widthMax:400,heightMax:300,onchoose:function(){}},seqCurrval:0,generatSeq:function(){return b.seqCurrval++},seqPanelMap:{},obviousOpt:function(a,b){if(b!=null){if(a.nowObviousOpt)a.nowObviousOpt.className=a.nowObviousOpt.ckb&&a.nowObviousOpt.ckb.checked?"optTxt chsd":"optTxt";if(b)b.className="optTxt msor",
a.nowObviousOpt=b}},scrollToObvious:function(a,b){if(b!=null)a.scrollTop=b.filtNm*20-parseInt(a.offsetHeight/2,10)+20},chooseOpt:function(a){var b=a.panel;if(a.ckb&&!a.ckb.checked)a.ckb.checked=!0;for(var c in a.panel.checkedCkbMap){var d=a.panel.checkedCkbMap[c];if(d!=null&&d.optTxt!=a)d.checked=!1,d.optTxt.className="optTxt"}a.panel.checkedCkbMap={};if(a.ckb)a.panel.checkedCkbMap[""+a.ckb.indNo]=a.ckb;c=a.value0;c=a.firstOptFlag?a.panel.customParams.firstOptTextInSrcElm:b.customParams.showTextMode==
"textValue"?a.value1+b.customParams.optDelimiter+a.value0:b.customParams.showTextMode=="valueText"?a.value0+b.customParams.optDelimiter+a.value1:b.customParams.showTextMode=="text"?a.value1:a.value0;a.panel.srcElm.value=c;a.panel.srcElm.values=[a.value0];a.panel.srcElm.texts=[c];a.panel.customParams.onchoose({srcElm:a.panel.srcElm,panel:a.panel,checked:!0,value:a.value0,text:c})},fillOpts:function(a,e){a.checkedCkbMap={};a.checkboxes=[];var c=0;if(!a.widthHelper)a.widthHelper=b.makeElm("span",document.body,
"SelectXx1WidthHelper",null,{display:""});if(a.customParams.hasFirstOpt){var d=a.customParams.optMode=="textValue"?a.customParams.firstOptText+a.customParams.optDelimiter+a.customParams.firstOptValue:a.customParams.optMode=="valueText"?a.customParams.firstOptValue+a.customParams.optDelimiter+a.customParams.firstOptText:a.customParams.firstOptText,d=b.escapeHtml(d);a.widthHelper.innerHTML=d;c=a.widthHelper.offsetWidth}for(var g=0;g<e.length;g++){var h=e[g],d=h.length==2?h[0]:h.k||h.key,h=h.length==
2?h[1]:h.v||h.value,d=a.customParams.optMode=="textValue"?h+a.customParams.optDelimiter+d:a.customParams.optMode=="valueText"?d+a.customParams.optDelimiter+h:h,d=b.escapeHtml(d);a.widthHelper.innerHTML=d;c=a.widthHelper.offsetWidth>c?a.widthHelper.offsetWidth:c}a.widthHelper.innerHTML="";a.innerHTML="";g=!1;d=(a.customParams.hasFirstOpt?1+e.length:e.length)*20;if(d>a.customParams.heightMax)d=a.customParams.heightMax,g=!0;c=a.customParams.multiSelectFlag?20+c:c;c=g?c+17:c;c=c<a.srcElm.offsetWidth-
4?a.srcElm.offsetWidth-4:c;c=c>a.customParams.widthMax?a.customParams.widthMax:c;b.setElmStyle(a,{width:c+"px",height:d+"px"});a.myWidth=c;a.myHeight=d;var c=(a.customParams.multiSelectFlag?c-20:c)-2,c=c>a.customParams.widthMax?a.customParams.widthMax:c,c=g?c-17:c,i=null;a.firstOpt=null;a.filtFirstOpt=null;var n=0,o=0;if(a.customParams.hasFirstOpt){var f=b.makeElm("DIV",a,"opt"),j=null;if(a.customParams.multiSelectFlag)var l=b.makeElm("DIV",f,"optCkb");f=b.makeElm("DIV",f,"optTxt",{value0:"",value1:a.customParams.firstOptTextInSrcElm,
opt:f},{width:c+"px"});d=a.customParams.optMode=="textValue"?a.customParams.firstOptText+a.customParams.optDelimiter+a.customParams.firstOptValue:a.customParams.optMode=="valueText"?a.customParams.firstOptValue+a.customParams.optDelimiter+a.customParams.firstOptText:a.customParams.firstOptText;f.value2=d;f.title=d;f.innerHTML=b.escapeHtml(d);f.firstOptFlag=!0;f.panel=a;if(a.firstOpt==null)a.firstOpt=f,a.filtFirstOpt=f;if(j)f.ckb=j,j.optTxt=f;if(i)i.next=f,i.filtNext=f;f.last=i;f.filtLast=i;f.filtNm=
n++;i=f;f.onmouseover=function(){var a=this.panel.eventHappenInfo;(!a.lastEventTime||!((a.lastEventKeydownKeyCode==38||a.lastEventKeydownKeyCode==40)&&(new Date).getTime()-a.lastEventTime<200))&&b.obviousOpt(this.panel,this)};f.onclick=function(){b.chooseOpt(this);b.closeSelect(this.panel.seq,!0)}}for(g=0;g<e.length;g++){h=e[g];d=h.length==2?h[0]:h.k||h.key;h=h.length==2?h[1]:h.v||h.value;j=null;f=b.makeElm("DIV",a,"opt");if(a.customParams.multiSelectFlag)l=b.makeElm("DIV",f,"optCkb"),j=b.makeElm("INPUT",
l,null,{type:"checkbox"}),j.panel=a,j.indNo=o,a.checkboxes[j.indNo]=j,o+=1;f=b.makeElm("DIV",f,"optTxt",{value0:d,value1:h,opt:f},{width:c+"px"});d=a.customParams.optMode=="textValue"?h+a.customParams.optDelimiter+d:a.customParams.optMode=="valueText"?d+a.customParams.optDelimiter+h:h;f.value2=d;f.title=d;f.innerHTML=b.escapeHtml(d);f.panel=a;if(a.firstOpt==null)a.firstOpt=f,a.filtFirstOpt=f;if(j)f.ckb=j,j.optTxt=f,j.onclick=function(){var a=this.panel;this.checked?(this.optTxt.className="optTxt chsd",
this.panel.checkedCkbMap[this.indNo]=this):(this.optTxt.className="optTxt",this.panel.checkedCkbMap[this.indNo]=null);var b=[],c=[],h;for(h in this.panel.checkedCkbMap){var d=this.panel.checkedCkbMap[h];if(d){var i=d.optTxt,f=i.value0;if(a.customParams.showTextMode=="textValue")f=i.value1+a.customParams.optDelimiter+i.value0;else if(a.customParams.showTextMode=="valueText")f=i.value0+a.customParams.optDelimiter+i.value1;else if(a.customParams.showTextMode=="text")f=i.value1;b[b.length]=f;c[c.length]=
d.optTxt.value0}}this.panel.srcElm.value=b.join(a.customParams.showTextDelimiter);this.panel.srcElm.texts=b;this.panel.srcElm.values=c;this.panel.customParams.onchoose({srcElm:this.panel.srcElm,panel:this.panel,checked:this.checked,value:this.optTxt.value0,text:this.optTxt.title})};if(i)i.next=f,i.filtNext=f;f.last=i;f.filtLast=i;f.filtNm=n++;i=f;f.onmouseover=function(){var a=this.panel.eventHappenInfo;(!a.lastEventTime||!((a.lastEventKeydownKeyCode==38||a.lastEventKeydownKeyCode==40)&&(new Date).getTime()-
a.lastEventTime<200))&&b.obviousOpt(this.panel,this)};f.onclick=function(){b.chooseOpt(this);b.closeSelect(this.panel.seq,!0);!this.panel.srcElm.readOnly&&this.panel.customParams.inputListen=="filt"&&!this.panel.customParams.multiSelectFlag&&b.filtOpts(this.panel)}}},filtOpts:function(a){if(!a.customParams.inputListen!="filt"){var e=a.srcElm.value;if(!(a.lastFiltValue==null&&e==""||a.lastFiltValue==e)){var c=a.firstOpt,d=null;a.filtFirstOpt=null;for(var g=0;;){if(c==null)break;e==""||c.value2.indexOf(e)!=
-1?(a.filtFirstOpt==null?(a.filtFirstOpt=c,c.filtLast=null):(c.filtLast=d,d.filtNext=c),c.filtNext=null,c.filtNm=g++,d=c,b.setElmStyle(c.opt,{display:""})):(c.filtNext=null,c.filtLast=null,b.setElmStyle(c.opt,{display:"none"}));c=c.next}a.lastFiltValue=e;b.obviousOpt(a,a.filtFirstOpt)}}},positionSelect:function(a){var e=a.selectXx1$Panel,c=b.getElmOffset(a),d=c.left+e.myWidth>document.body.clientWidth?document.body.clientWidth-e.myWidth-5:c.left;b.setElmStyle(e,{visibility:"visible",display:"",left:d+
"px",top:c.bottom+"px"});e.statusShow=!0;a.className=e.srcElmOrigClassName+" SelectXx1FocusElmStyle";window.setTimeout(function(){c=b.getElmOffset(a);d=c.left+e.myWidth>document.body.clientWidth?document.body.clientWidth-e.myWidth-5:c.left;b.setElmStyle(e,{visibility:"visible",display:"",left:d+"px",top:c.bottom+"px"})},1)},closeSelect:function(a,e){var c=b.seqPanelMap[a];if(!c.cursorOn||e)c.style.display="none",c.srcElm.className=c.srcElmOrigClassName,c.statusShow=!1},makeSelect:function(a,e,c,d){a.selectXx1$Panel!=
null&&(b.seqPanelMap[a.selectXx1$Panel.seq]=null,document.body.removeChild(a.selectXx1$Panel));var g=b.makeElm("DIV",document.body,"SelectXx1Panel",{srcElm:a,srcElmOrigClassName:a.className,cursorOn:!0,optListOrUrl:e,seq:b.generatSeq(),innerHTML:'<div class="opt"><div class="optTxt">\u52a0\u8f7d\u6570\u636e\u4e2d...</div></div>'},{display:"none",width:a.offsetWidth-4+"px"});b.seqPanelMap[g.seq]=g;a.selectXx1$Panel=g;g.customParams=b.mergeObjectAttrs([b.defaultCustomParams,c==null?null:b.allCustomParamsEnum[c],
d==null?null:d]);g.onmouseover=function(){this.cursorOn=!0};g.onmouseout=function(){this.cursorOn=!1;window.setTimeout("SelectXx1.closeSelect( '"+this.seq+"' )",10)};g.oncontextmenu=function(a){a=a||window.event;a.preventDefault&&a.preventDefault();return!1};g.onmouseup=function(){this.srcElm.focus()};a.selectXx1$AddedEvent=a.selectXx1$AddedEvent||{};g.eventHappenInfo={};if(!a.onclick)a.onclick=function(a){b.activate(a)};if(!a.selectXx1$AddedEvent.mouseover)b.addEvent(a,"mouseover",function(){if(a.selectXx1$Panel&&
a.selectXx1$Panel.statusShow)a.selectXx1$Panel.cursorOn=!0}),a.selectXx1$AddedEvent.mouseover=!0;if(!a.selectXx1$AddedEvent.mouseout)b.addEvent(a,"mouseout",function(){if(a.selectXx1$Panel)a.selectXx1$Panel.cursorOn=!1,window.setTimeout("SelectXx1.closeSelect( '"+a.selectXx1$Panel.seq+"' )",10)}),a.selectXx1$AddedEvent.mouseout=!0;if(!a.selectXx1$AddedEvent.blur)b.addEvent(a,"blur",function(){a.selectXx1$Panel&&window.setTimeout("SelectXx1.closeSelect( '"+a.selectXx1$Panel.seq+"' )",10)}),a.selectXx1$AddedEvent.blur=
!0;if(!a.selectXx1$AddedEvent.keyup)b.addEvent(a,"keyup",function(c){var d=a.selectXx1$Panel;if(d){c=(c||window.event).keyCode;if(c!=38&&c!=40&&c!=13&&c!=27&&!a.readOnly)if(d.customParams.inputListen=="filt"&&!d.customParams.multiSelectFlag){if(!d.willFilt)d.willFilt=!0,window.setTimeout(function(){d.willFilt=!1;b.filtOpts(d)},360)}else if(d.customParams.inputListen=="match"&&d.customParams.multiSelectFlag){for(var c=a.value.split(d.customParams.showTextDelimiter),g=d.customParams.inputMatchMode,
e=d.filtFirstOpt,f=[],j=[],l={};;){if(e==null)break;for(var k=!1,m=0;m<c.length;m++)if(g=="value"&&c[m]==e.value0||g=="text"&&c[m]==e.value1||(g=="textValue"||g=="valueText")&&c[m]==e.value2){k=!0;break}if(e.ckb)e.ckb.checked=k,l[e.ckb.indNo]=k?e.ckb:null;k?(e.className="optTxt chsd",k=e.value0,k=e.firstOptFlag?d.customParams.firstOptTextInSrcElm:d.customParams.showTextMode=="textValue"?e.value1+d.customParams.optDelimiter+e.value0:d.customParams.showTextMode=="valueText"?e.value0+d.customParams.optDelimiter+
e.value1:d.customParams.showTextMode=="text"?e.value1:e.value0,f[f.length]=k,j[j.length]=e.value0):e.className="optTxt";e=e.filtNext}a.texts=f;a.values=j;d.checkedCkbMap=l}if(a.value=="")a.values=[]}}),a.selectXx1$AddedEvent.keyup=!0;if(!a.selectXx1$AddedEvent.keydown)b.addEvent(a,"keydown",function(c){var d=a.selectXx1$Panel;if(d){var c=c||window.event,e=!1;d.eventHappenInfo.lastEventKeydownKeyCode=c.keyCode;d.eventHappenInfo.lastEventTime=(new Date).getTime();c.keyCode==38?(b.obviousOpt(d,d.nowObviousOpt?
d.nowObviousOpt.filtLast:null),b.scrollToObvious(d,d.nowObviousOpt),e=!0):c.keyCode==40?(d.statusShow?(b.obviousOpt(d,d.nowObviousOpt?d.nowObviousOpt.filtNext:d.filtFirstOpt),b.scrollToObvious(d,d.nowObviousOpt)):b.positionSelect(a),e=!0):c.keyCode==13?(d.statusShow?d.nowObviousOpt&&(b.chooseOpt(d.nowObviousOpt),b.closeSelect(d.seq,!0),!a.readOnly&&d.customParams.inputListen=="filt"&&!d.customParams.multiSelectFlag&&b.filtOpts(d)):b.positionSelect(a),e=!0):c.keyCode==27&&b.closeSelect(d.seq,!0);if(e)return c.preventDefault&&
c.preventDefault(),!1}}),a.selectXx1$AddedEvent.keydown=!0;typeof g.optListOrUrl=="string"?b.ajax(g.optListOrUrl,{},function(c){c=eval(c);b.fillOpts(g,c);!a.readOnly&&g.customParams.inputListen=="filt"&&!g.customParams.multiSelectFlag&&b.filtOpts(g)}):(b.fillOpts(g,g.optListOrUrl),!a.readOnly&&g.customParams.inputListen=="filt"&&!g.customParams.multiSelectFlag&&b.filtOpts(g))},reset:function(a,e,c,d){a.value="";a.texts=[];a.values=[];b.makeSelect(a,e,c,d)},clean:function(a){if(a.selectXx1$Panel!=
null)a.selectXx1$Panel.cursorOn=!1,b.seqPanelMap[a.selectXx1$Panel.seq]=null,document.body.removeChild(a.selectXx1$Panel),a.selectXx1$Panel=null;a.onclick=null;a.value="";a.texts=[];a.values=[]},activate:function(a,e,c,d){if(!b.appendCssFlag)b.appendCss(),b.appendCssFlag=!0;var a=a||window.event,a=a.target||a.srcElement,g=a.selectXx1$Panel;g?g.cursorOn=!0:b.makeSelect(a,e,c,d);b.positionSelect(a);a.focus()}};b.allCustomParamsEnum={101:b.mergeObjectAttrs([b.defaultCustomParams,{multiSelectFlag:!1}]),
102:b.mergeObjectAttrs([b.defaultCustomParams,{multiSelectFlag:!1,hasFirstOpt:!1,inputListen:"filt"}]),103:b.mergeObjectAttrs([b.defaultCustomParams,{multiSelectFlag:!1,optMode:"valueText",showTextMode:"valueText"}]),104:b.mergeObjectAttrs([b.defaultCustomParams,{multiSelectFlag:!1,hasFirstOpt:!1,optMode:"valueText",showTextMode:"valueText",inputListen:"filt"}]),105:b.mergeObjectAttrs([b.defaultCustomParams,{multiSelectFlag:!1,showTextMode:"valueText"}]),201:b.mergeObjectAttrs([b.defaultCustomParams,
{}]),202:b.mergeObjectAttrs([b.defaultCustomParams,{inputListen:"match"}]),203:b.mergeObjectAttrs([b.defaultCustomParams,{optMode:"valueText",showTextMode:"value",inputListen:"match",inputMatchMode:"value"}]),204:b.mergeObjectAttrs([b.defaultCustomParams,{hasFirstOpt:!1,optMode:"text",showTextMode:"text"}]),205:b.mergeObjectAttrs([b.defaultCustomParams,{hasFirstOpt:!1,optMode:"valueText",showTextMode:"value"}]),206:b.mergeObjectAttrs([b.defaultCustomParams,{hasFirstOpt:!1,optMode:"valueText",showTextMode:"valueText"}])};
window.SelectXx1=b})();
